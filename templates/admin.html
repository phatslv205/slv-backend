<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>SolverViet Admin - Äiá»u HÆ°á»›ng</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
<style>body { margin: 0; font-family: 'Segoe UI', sans-serif; background-color: #1e1e2e; color: #f1f1f1; }
.sidebar { height: 100vh; width: 240px; position: fixed; top: 0; left: 0; background-color: #111827; color: white; padding-top: 20px; border-right: 1px solid #2d3748; }
.sidebar h2 { text-align: center; font-size: 18px; margin-bottom: 30px; color: #000000; }
.sidebar a { display: block; color: #e5e7eb; padding: 12px 20px; text-decoration: none; font-size: 15px; transition: all 0.2s; }
.sidebar a:hover { background-color: #374151; color: #ffffff; }
.main { margin-left: 260px; padding: 40px; }
.btn-custom { background-color: #3b82f6; color: white; border: none; padding: 8px 14px; border-radius: 6px; font-size: 15px; margin-bottom: 12px; }
.btn-custom:hover { background-color: #2563eb; }
hr { border-top: 1px solid #4b5563; }
.card-box { background-color: #2d2d3a; padding: 16px; border-radius: 8px; color: #f1f5f9; }
@keyframes fadeIn { from { opacity: 0; transform: scale(0.96); } to { opacity: 1; transform: scale(1); } }
body { animation: fadeIn 0.6s ease-in-out; }
@keyframes slide-down { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
.animate-slide-down { animation: slide-down 0.3s ease-out; }</style>

</head>
<body>
<div id="toast-container" style="
  position: fixed;
  top: 20px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 9999;
  display: flex;
  flex-direction: column;
  gap: 10px;
"></div>

<div class="sidebar">
  <h2> SolverViet Admin</h2>
  <a href="/admin_users"> NgÆ°á»i dÃ¹ng</a>
  <a href="/admin/review"> GÃ³i VIP chá» duyá»‡t</a>
  <a href="/admin/gop-y">GÃ³p Ã½{% if feedback_count and feedback_count > 0 %} <span class="bg-red-600 text-white text-xs font-semibold px-2 py-0.5 rounded-full">{{ feedback_count }}</span>{% endif %}</a>
  <a href="/admin/gui-thong-bao"> Gá»­i thÃ´ng bÃ¡o</a>
  <a href="/admin/bao-tri"> Báº£o trÃ¬ há»‡ thá»‘ng</a>
  <a href="/admin/daily_stats"> Thá»‘ng kÃª AI má»—i ngÃ y</a>
  <a href="/server_status">ğŸ“¡ Tráº¡ng thÃ¡i Server</a>
</div>

<div class="main" id="defaultBox">
  <h2>Trung tÃ¢m Ä‘iá»u hÃ nh SolverViet</h2>
  <p>Chá»n chá»©c nÄƒng quáº£n lÃ½ tá»« thanh menu bÃªn trÃ¡i.</p>


<!-- Ghi chÃº há»‡ thá»‘ng tá»•ng há»£p -->
<div style="background-color: #000000; border: 1px solid #5a5a5a; padding: 20px; border-radius: 10px; margin-top: 24px; font-size: 15px;">

  <strong>ğŸ§¹ Dá»n chat cÅ© má»—i Ä‘áº§u thÃ¡ng:</strong><br>
  Äá»ƒ trÃ¡nh náº·ng há»‡ thá»‘ng, admin nÃªn xoÃ¡ bá»›t chat cÅ© trong báº£ng <code>chat_history</code> báº±ng cÃ¢u lá»‡nh sau:
  <div style="position: relative; margin-top: 12px; margin-bottom: 20px;">
    <pre id="code1" style="background: #1e1e1e; color: #00c3ff; padding: 12px 16px; border-radius: 6px; font-family: monospace; font-size: 14px; overflow-x: auto;">
DELETE FROM chat_history
WHERE timestamp &lt; CURRENT_DATE;
    </pre>
    <button onclick="copyCode('code1')" title="Sao chÃ©p" style="position: absolute; top: 8px; right: 8px; background: none; border: none; cursor: pointer;">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="white" viewBox="0 0 24 24">
        <path d="M16 1H8C7.44772 1 7 1.44772 7 2V4H6C4.89543 4 4 4.89543 4 6V20C4 21.1046 4.89543 22 6 22H18C19.1046 22 20 21.1046 20 20V6C20 4.89543 19.1046 4 18 4H17V2C17 1.44772 16.5523 1 16 1ZM9 3H15V4H9V3ZM18 6V20H6V6H18Z"/>
      </svg>
    </button>
  </div>

  <strong>ğŸ–¼ï¸ Dá»n áº£nh AI cÅ© sau 15 ngÃ y:</strong><br>
  DÃ¹ng Ä‘á»ƒ xoÃ¡ dá»¯ liá»‡u áº£nh Ä‘Ã£ táº¡o lÃ¢u tá»« báº£ng <code>image_history</code>:
  <div style="position: relative; margin-top: 12px; margin-bottom: 20px;">
    <pre id="code2" style="background: #1e1e1e; color: #00d1ec; padding: 12px 16px; border-radius: 6px; font-family: monospace; font-size: 14px; overflow-x: auto;">
DELETE FROM image_history
WHERE created_at &lt; CURRENT_DATE - INTERVAL '15 days';
    </pre>
    <button onclick="copyCode('code2')" title="Sao chÃ©p" style="position: absolute; top: 8px; right: 8px; background: none; border: none; cursor: pointer;">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="white" viewBox="0 0 24 24">
        <path d="M16 1H8C7.44772 1 7 1.44772 7 2V4H6C4.89543 4 4 4.89543 4 6V20C4 21.1046 4.89543 22 6 22H18C19.1046 22 20 21.1046 20 20V6C20 4.89543 19.1046 4 18 4H17V2C17 1.44772 16.5523 1 16 1ZM9 3H15V4H9V3ZM18 6V20H6V6H18Z"/>
      </svg>
    </button>
  </div>

  <strong>ğŸ” Cáº­p nháº­t service:</strong><br>
  Má»—i khi chá»‰nh sá»­a mÃ£ nguá»“n hoáº·c giao diá»‡n, hÃ£y cháº¡y lá»‡nh sau Ä‘á»ƒ Ã¡p dá»¥ng thay Ä‘á»•i:
  <div style="position: relative; margin-top: 12px; margin-bottom: 20px;">
    <pre id="code3" style="background: #1e1e1e; color: #00ffff; padding: 12px 16px; border-radius: 6px; font-family: monospace; font-size: 14px; overflow-x: auto;">
sudo systemctl restart slv.service
    </pre>
    <button onclick="copyCode('code3')" title="Sao chÃ©p" style="position: absolute; top: 8px; right: 8px; background: none; border: none; cursor: pointer;">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="white" viewBox="0 0 24 24">
        <path d="M16 1H8C7.44772 1 7 1.44772 7 2V4H6C4.89543 4 4 4.89543 4 6V20C4 21.1046 4.89543 22 6 22H18C19.1046 22 20 21.1046 20 20V6C20 4.89543 19.1046 4 18 4H17V2C17 1.44772 16.5523 1 16 1ZM9 3H15V4H9V3ZM18 6V20H6V6H18Z"/>
      </svg>
    </button>
  </div>

  <strong>ğŸš€ Dá»n RAM vÃ  log khi há»‡ thá»‘ng quÃ¡ táº£i:</strong><br>
  Náº¿u tháº¥y VPS bá»‹ náº·ng, báº¡n cÃ³ thá»ƒ thá»§ cÃ´ng cháº¡y lá»‡nh sau Ä‘á»ƒ dá»n RAM, cache, log vÃ  áº£nh AI cÅ©:
  <div style="position: relative; margin-top: 12px;">
    <pre id="code4" style="background: #1e1e1e; color: #f2b05e; padding: 12px 16px; border-radius: 6px; font-family: monospace; font-size: 14px; overflow-x: auto;">
/root/clean_up_daily.sh
    </pre>
    <button onclick="copyCode('code4')" title="Sao chÃ©p" style="position: absolute; top: 8px; right: 8px; background: none; border: none; cursor: pointer;">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="white" viewBox="0 0 24 24">
        <path d="M16 1H8C7.44772 1 7 1.44772 7 2V4H6C4.89543 4 4 4.89543 4 6V20C4 21.1046 4.89543 22 6 22H18C19.1046 22 20 21.1046 20 20V6C20 4.89543 19.1046 4 18 4H17V2C17 1.44772 16.5523 1 16 1ZM9 3H15V4H9V3ZM18 6V20H6V6H18Z"/>
      </svg>
    </button>
  </div>
  <hr style="border-color: #5a5a5a; margin: 32px 0;">

  <strong>ğŸ” Kiá»ƒm tra tá»« trong tá»« Ä‘iá»ƒn:</strong><br>
  DÃ¹ng Ä‘á»ƒ tra nhanh xem tá»« báº¡n Ä‘á»‹nh thÃªm Ä‘Ã£ cÃ³ trong file `viet_dictionary.json` chÆ°a.

  <div style="margin-top: 12px; padding: 16px; background: #1e1e1e; border: 1px solid #5a5a5a; border-radius: 8px;">
    <div style="display: flex; gap: 12px; flex-wrap: wrap;">
      <input id="search_tu" placeholder="Nháº­p cá»¥m tá»« cáº§n kiá»ƒm tra..."
        style="flex: 1; padding: 10px 14px; border-radius: 6px; border: 1px solid #5a5a5a; background: #2a2a2a; color: white; font-size: 14px;" />
      <button onclick="checkTuTrongTuDien()" style="background: #2563eb; color: white; padding: 10px 20px; border: none; border-radius: 6px; cursor: pointer; font-size: 14px;">
        Kiá»ƒm tra
      </button>
    </div>
    <div id="result_check_tu" style="margin-top: 12px; color: #c0c0c0; font-size: 14px;"></div>
    <p style="margin-top: 12px; font-size: 14px; color: #cccccc;">
 <em>Náº¿u cÃ³ ngÆ°á»i dÃ¹ng gÃ³p Ã½ cá»¥m tá»«, sau khi táº¡o Ä‘oáº¡n JSON, báº¡n nhá»› thÃªm dÃ²ng:</em><br>
<code style="color: #00e0ff;">"nguoi_cung_cap": "TÃªn ngÆ°á»i dÃ¹ng"</code><br>
<em>VÃ­ dá»¥:</em> <code style="color: #7fffd4;">"nguoi_cung_cap": "PhÃ¡t Nguyá»…n"</code>
</p>

  </div>

</div>


  <hr>
<div style="display: flex; gap: 12px; flex-wrap: wrap; margin-top: 14px; justify-content: center;">

  <a href="https://platform.openai.com/account/billing" target="_blank" style="
    display: inline-block;
    width: 240px;
    text-align: center;
    background: linear-gradient(135deg, #22c55e, #16a34a);
    color: white;
    padding: 12px 18px;
    font-size: 15px;
    border-radius: 8px;
    text-decoration: none;
    font-weight: 600;
    box-shadow: 0 4px 10px rgba(34, 197, 94, 0.3);
    transition: all 0.25s ease;
  "
  onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 14px rgba(34, 197, 94, 0.45)';"
  onmouseout="this.style.transform='none'; this.style.boxShadow='0 4px 10px rgba(34, 197, 94, 0.3)';"
  >
    âœ… Core
  </a>

  <!-- Dá»n chat -->
  <button onclick="cleanupChats()" style="
    display: inline-block;
    width: 240px;
    text-align: center;
    background: linear-gradient(135deg, #ef4444, #b91c1c);
    color: white;
    padding: 12px 18px;
    font-size: 15px;
    border: none;
    border-radius: 8px;
    font-weight: 600;
    box-shadow: 0 4px 10px rgba(239, 68, 68, 0.3);
    transition: all 0.25s ease;
    cursor: pointer;
  "
  onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 14px rgba(239, 68, 68, 0.5)';"
  onmouseout="this.style.transform='none'; this.style.boxShadow='0 4px 10px rgba(239, 68, 68, 0.3)';"
  >
    ğŸ§¹ Dá»n chat quÃ¡ 30 ngÃ y
  </button>
<button onclick="cleanupOldAIImages()" style="
  display: inline-block;
  width: 240px;
  text-align: center;
  background: linear-gradient(135deg, #06b6d4, #0e7490);
  color: white;
  padding: 12px 18px;
  font-size: 15px;
  border: none;
  border-radius: 8px;
  font-weight: 600;
  box-shadow: 0 4px 10px rgba(6, 182, 212, 0.3);
  transition: all 0.25s ease;
  cursor: pointer;
"
onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 14px rgba(6, 182, 212, 0.45)';"
onmouseout="this.style.transform='none'; this.style.boxShadow='0 4px 10px rgba(6, 182, 212, 0.3)';"
>
  ğŸ–¼ï¸ Dá»n áº£nh AI quÃ¡ 30 ngÃ y
</button>
  <!-- Logout -->
  <a href="/logout" style="
    display: inline-block;
    width: 240px;
    text-align: center;
    background: linear-gradient(135deg, #f87171, #b91c1c);
    color: white;
    padding: 12px 18px;
    font-size: 15px;
    font-weight: 600;
    border-radius: 8px;
    text-decoration: none;
    box-shadow: 0 4px 10px rgba(248, 113, 113, 0.3);
    transition: all 0.25s ease;
  "
  onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 14px rgba(248, 113, 113, 0.5)';"
  onmouseout="this.style.transform='none'; this.style.boxShadow='0 4px 10px rgba(248, 113, 113, 0.3)';"
  >
    ğŸ” Secure Logout
  </a>

</div>


<div class="mt-3 animate-slide-down" style="font-size: 15px;">
<div style="background-color: #111827; color: #f3f4f6; padding: 25px; border-radius: 12px; line-height: 1.65; font-size: 15px;">
  <strong class="text-cyan-400 text-lg">ğŸ“˜ Ghi chÃº Ä‘áº§y Ä‘á»§ cÃ¡c cá»™t trong báº£ng <code>users</code>:</strong>

  <h5 class="mt-4 font-bold text-pink-400">ğŸ§‘â€ğŸ’¼ ThÃ´ng tin cÃ¡ nhÃ¢n</h5>
  <ul class="ml-5 list-disc">
    <li><code>user_id</code>: ID duy nháº¥t (UUID dáº¡ng chuá»—i)</li>
    <li><code>username</code>: TÃªn Ä‘Äƒng nháº­p</li>
    <li><code>password</code>: Máº­t kháº©u (Ä‘Ã£ mÃ£ hÃ³a)</li>
    <li><code>email</code>: Email ngÆ°á»i dÃ¹ng</li>
    <li><code>fullname</code>: Há» tÃªn Ä‘áº§y Ä‘á»§</li>
    <li><code>avatar_url</code>: URL avatar Ä‘áº¡i diá»‡n</li>
    <li><code>bio</code>: Tiá»ƒu sá»­ (giá»›i thiá»‡u báº£n thÃ¢n)</li>
    <li><code>bio_updated_at</code>: Thá»i gian cáº­p nháº­t tiá»ƒu sá»­</li>
    <li><code>privacy</code>: CÃ i Ä‘áº·t riÃªng tÆ° (JSON)</li>
  </ul>
   <h5 class="mt-8 font-bold text-red-400">âš™ï¸ CÃ¡ch giáº£m lag cho server khi CPU NEWORD cao</h5>
<ul class="ml-5 list-disc">
  <li>Cháº¡y <code>pkill -f vscode-server</code> Ä‘á»ƒ káº¿t thÃºc toÃ n bá»™ tiáº¿n trÃ¬nh phá»¥ tá»« VSCode Remote (khÃ´ng áº£nh hÆ°á»Ÿng há»‡ thá»‘ng).</li>
  <li>Náº¿u cáº§n thiáº¿t, dá»n cache báº±ng <code>rm -rf ~/.vscode-server</code> Ä‘á»ƒ VSCode tá»± cÃ i láº¡i server.</li>
  <li>Má»Ÿ láº¡i VSCode, nháº¥n <strong>Ctrl + Shift + P</strong> â†’ chá»n <code>Python: Select Interpreter</code> vÃ  chá»n Ä‘Ãºng mÃ´i trÆ°á»ng nhÆ° <code>~/slv_project/venv/bin/python</code>.</li>
  <li>Cuá»‘i cÃ¹ng, chá»n láº¡i <code>Python: Restart Language Server</code> Ä‘á»ƒ VSCode nháº­n láº¡i thÆ° viá»‡n.</li>
  <li>TrÃ¡nh má»Ÿ quÃ¡ nhiá»u tab VSCode hoáº·c Ä‘á»ƒ session treo, sáº½ gÃ¢y ngá»‘n CPU.</li>
</ul>

  <h5 class="mt-4 font-bold text-yellow-400">ğŸ” XÃ¡c thá»±c & tráº¡ng thÃ¡i</h5>
  <ul class="ml-5 list-disc">
    <li><code>is_blocked</code>: TÃ i khoáº£n bá»‹ khÃ³a hay khÃ´ng</li>
    <li><code>otp_code</code>: MÃ£ OTP gáº§n nháº¥t</li>
    <li><code>wants_verification</code>: ÄÃ£ yÃªu cáº§u xÃ¡c thá»±c chÆ°a</li>
    <li><code>is_verified</code>: ÄÃ£ xÃ¡c thá»±c email hay chÆ°a</li>
    <li><code>email_temp</code>: Email táº¡m khi Ä‘á»•i email</li>
  </ul>
  <h5 class="mt-6 font-bold text-green-400">ğŸ“¦ Backup toÃ n bá»™ dá»± Ã¡n Flask tá»« VPS vá» mÃ¡y</h5>
<ul class="ml-5 list-disc text-sm leading-relaxed">
  <li><b>BÆ°á»›c 1</b>: TrÃªn VS Code (Ä‘ang káº¿t ná»‘i SSH), cháº¡y:
    <br><code>cd ..</code>
    <br><code>zip -r slv_project.zip slv_project</code>
    <br><code>zip -r slv_project_full.zip .</code><a>sáº½ lÃ  nÃ©n toÃ n bá»™ thÃ nh dá»± Ã¡n báº±ng zip ká»ƒ cáº£ venv.</a>
    <br><i>(Lá»‡nh nÃ y sáº½ nÃ©n toÃ n bá»™ thÆ° má»¥c <code>slv_project</code> thÃ nh file <code>slv_project.zip</code>)</i>
  </li>
  <li><b>BÆ°á»›c 2</b>: Kiá»ƒm tra xem file zip Ä‘Ã£ táº¡o xong chÆ°a báº±ng:
    <br><code>ls -lh</code>
    <br><i>(Äáº£m báº£o file <code>slv_project.zip</code> cÃ³ dung lÆ°á»£ng Ä‘Ãºng)</i>
  </li>
  <li><b>BÆ°á»›c 3</b>: TrÃªn mÃ¡y cÃ¡ nhÃ¢n (Windows), má»Ÿ PowerShell vÃ  cháº¡y:
    <br><code>scp root@45.252.248.215:/root/slv_project.zip C:\Users\Admin\Downloads\</code>
    <br><i>(Thay IP náº¿u cáº§n. Khi Ä‘Æ°á»£c yÃªu cáº§u, hÃ£y nháº­p máº­t kháº©u VPS)</i>
  </li>
  <li><b>BÆ°á»›c 4</b>: Sau khi táº£i xong, vÃ o thÆ° má»¥c <code>Downloads</code> vÃ  giáº£i nÃ©n file <code>slv_project.zip</code> Ä‘á»ƒ láº¥y láº¡i toÃ n bá»™ mÃ£ nguá»“n</li>
</ul>

<h5 class="mt-4 font-bold text-blue-400">ğŸ—„ï¸ HÆ°á»›ng dáº«n sao lÆ°u & khÃ´i phá»¥c dá»¯ liá»‡u SQL (PostgreSQL)</h5>
<ul class="ml-5 list-disc">
  <li><code>1. Táº¡o thÆ° má»¥c backup (1 láº§n duy nháº¥t):</code> <br> 
      <code>mkdir -p /home/backup</code>
  </li>

  <li><code>2. Táº¡o file script sao lÆ°u:</code> <br> 
      <code>nano /home/backup/full_backup.sh</code>
  </li>

  <li><code>3. Ná»™i dung file:</code> <br>
    <code>
    #!/bin/bash<br>
    export PGPASSWORD="slv2025"<br>
    DATE=$(date +%F)<br>
    pg_dump -U postgres -h 127.0.0.1 -d slv_users > /home/backup/slv_db_$DATE.sql
    </code>
  </li>

  <li><code>4. Cáº¥p quyá»n cháº¡y script:</code> <br> 
      <code>chmod +x /home/backup/full_backup.sh</code>
  </li>

  <li><code>5. Cháº¡y script Ä‘á»ƒ sao lÆ°u ngay:</code> <br> 
      <code>bash /home/backup/full_backup.sh</code>
  </li>

  <li><code>6. File .sql sau khi sao lÆ°u sáº½ náº±m táº¡i:</code> <br> 
      <code>/home/backup/slv_db_YYYY-MM-DD.sql</code>
  </li>

  <li><code>7. Äá»ƒ táº£i vá» mÃ¡y tÃ­nh (tá»« bÃªn ngoÃ i VPS):</code> <br> 
    <code>
    scp root@45.252.248.215:/home/backup/slv_db_YYYY-MM-DD.sql ~/Desktop/
    </code>
  </li>

  <li><code>8. Sau nÃ y náº¿u máº¥t DB:</code><br>
    - Náº¿u DB cÃ²n tá»“n táº¡i nhÆ°ng máº¥t dá»¯ liá»‡u, khÃ´i phá»¥c báº±ng: <br>
    <code>PGPASSWORD="slv2025" psql -U postgres -h 127.0.0.1 -d slv_users &lt; /home/backup/slv_db_YYYY-MM-DD.sql</code><br><br>
    - Náº¿u DB Ä‘Ã£ bá»‹ xÃ³a, táº¡o láº¡i rá»“i khÃ´i phá»¥c: <br>
    <code>
    PGPASSWORD="slv2025" createdb -U postgres -h 127.0.0.1 slv_users<br>
    PGPASSWORD="slv2025" psql -U postgres -h 127.0.0.1 -d slv_users &lt; /home/backup/slv_db_YYYY-MM-DD.sql
    </code>
  </li>

  <li><code>ğŸ’¡ Gá»£i Ã½:</code> CÃ³ thá»ƒ thiáº¿t láº­p cronjob Ä‘á»ƒ tá»± Ä‘á»™ng backup má»—i ngÃ y hoáº·c má»—i tuáº§n. <br>
    VÃ­ dá»¥: má»Ÿ cron báº±ng <code>crontab -e</code> vÃ  thÃªm dÃ²ng: <br>
    <code>0 2 * * * /home/backup/full_backup.sh</code>
  </li>
</ul>


  <h5 class="mt-6 font-bold text-green-400">ğŸ›  Quáº£n trá»‹ há»‡ thá»‘ng Flask & VPS</h5>
<ul class="ml-5 list-disc text-sm leading-relaxed">
  <li><code>sudo systemctl status slv.service</code>: Kiá»ƒm tra Flask server cÃ³ Ä‘ang cháº¡y khÃ´ng</li>
  <li><code>sudo lsof -i :5000</code>: Kiá»ƒm tra Flask Ä‘Ã£ chiáº¿m cá»•ng 5000 chÆ°a (náº¿u dÃ¹ng SocketIO)</li>
  <li><code>journalctl -u slv.service -n 50</code>: Xem log má»›i nháº¥t cá»§a Flask (giÃºp debug khi lá»—i)</li>
  <li><code>htop</code>: Kiá»ƒm tra CPU/RAM theo thá»i gian thá»±c (dá»… theo dÃµi hÆ¡n <code>top</code>)</li>
  <li><code>df -h</code>: Kiá»ƒm tra dung lÆ°á»£ng VPS (trÃ¡nh bá»‹ Ä‘áº§y á»• gÃ¢y lá»—i)</li>
  <li><code>sudo certbot certificates</code>: Xem chá»©ng chá»‰ SSL vÃ  ngÃ y háº¿t háº¡n</li>
</ul>

  <h5 class="mt-4 font-bold text-blue-400">ğŸ“¶ Tráº¡ng thÃ¡i hoáº¡t Ä‘á»™ng</h5>
  <ul class="ml-5 list-disc">
    <li><code>created_at</code>: NgÃ y táº¡o tÃ i khoáº£n</li>
    <li><code>last_seen</code>: Thá»i Ä‘iá»ƒm hoáº¡t Ä‘á»™ng cuá»‘i</li>
    <li><code>online</code>: Äang online hay khÃ´ng</li>
  </ul>

  <h5 class="mt-4 font-bold text-purple-400">ğŸ’¬ Cáº¥u hÃ¬nh AI & cÃ¡ nhÃ¢n hÃ³a</h5>
  <ul class="ml-5 list-disc">
    <li><code>ai_personality</code>: TÃ­nh cÃ¡ch AI Ä‘Ã£ chá»n</li>
    <li><code>ai_system_prompt</code>: Prompt há»‡ thá»‘ng cÃ¡ nhÃ¢n</li>
    <li><code>ai_personality_rolls_left</code>: 5 lÆ°á»£t Ä‘áº§u chÆ°a xÃ¡c thá»±c Ä‘á»ƒ thay Ä‘á»•i AI</li>
    <li><code>ai_personality_rolls_reset</code>: Thá»i Ä‘iá»ƒm reset lÆ°á»£t chá»n tÃ­nh cÃ¡ch</li>
  </ul>

  <h5 class="mt-4 font-bold text-red-400">âš¡ï¸ Quáº£n lÃ½ lÆ°á»£t sá»­ dá»¥ng AI</h5>
  <ul class="ml-5 list-disc">
    <li><code>free_gpt_uses</code>: 15 lÆ°á»£t miá»…n phÃ­ sau khi xÃ¡c thá»±c</li>
    <li><code>daily_fallback_uses</code>: 5 lÆ°á»£t má»—i ngÃ y náº¿u khÃ´ng cÃ³ gÃ³i Lite/SLV</li>
    <li><code>daily_fallback_date</code>: NgÃ y sá»­ dá»¥ng fallback gáº§n nháº¥t</li>
    <li><code>daily_fallback_uses</code>: <b>5 lÆ°á»£t fallback má»—i ngÃ y</b> náº¿u khÃ´ng cÃ³ gÃ³i SLV hoáº·c AI Lite</li>
    <li><code>gpt_usage_today</code>: Tá»•ng lÆ°á»£t GPT dÃ¹ng hÃ´m nay</li>
    <li><code>gpt_usage_date</code>: NgÃ y tÆ°Æ¡ng á»©ng cá»§a gpt_usage_today</li>
  </ul>

  <h5 class="mt-4 font-bold text-green-400">ğŸŸï¸ GÃ³i & quyá»n truy cáº­p</h5>
  <ul class="ml-5 list-disc">
    <li><code>vip_until_gpt</code>: Háº¡n gÃ³i SLV (GPT khÃ´ng giá»›i háº¡n)</li>
    <li><code>vip_until_lite</code>: Háº¡n gÃ³i AI Lite (50 lÆ°á»£t/ngÃ y)</li>
    <li><code>vip_gpt</code>: TÃªn gÃ³i SLV Ä‘ang dÃ¹ng</li>
    <li><code>vip_gpt_ai</code>: CÃ³ gÃ³i SLV AI khÃ´ng</li>
    <li><code>vip_ai_lite</code>: CÃ³ gÃ³i AI Lite khÃ´ng</li>
  </ul>

  <h5 class="mt-4 font-bold text-indigo-400">ğŸ“Š Theo dÃµi gÃ³i AI Lite</h5>
  <ul class="ml-5 list-disc">
    <li><code>lite_usage</code>: LÆ°á»£t dÃ¹ng AI Lite trong hÃ´m nay (tá»‘i Ä‘a 50)</li>
    <li><code>lite_date</code>: NgÃ y dÃ¹ng gáº§n nháº¥t cá»§a AI Lite (dÃ¹ng Ä‘á»ƒ reset lÆ°á»£t)</li>
    <li><code>last_lite_free_date</code>: NgÃ y reset lÆ°á»£t fallback má»—i ngÃ y (trÆ°á»ng cÅ©)</li>
  </ul>

  <h5 class="mt-4 font-bold text-rose-400">â›” Quáº£n lÃ½ giá»›i háº¡n & cháº·n</h5>
  <ul class="ml-5 list-disc">
    <li><code>over_quota_block</code>: Bá»‹ cháº·n vÃ¬ dÃ¹ng quÃ¡ giá»›i háº¡n</li>
    <li><code>over_quota_block_at</code>: Thá»i Ä‘iá»ƒm bá»‹ cháº·n do quÃ¡ quota</li>
    <li><code>gpt_unlimited</code>: Cá» ná»™i bá»™ má»Ÿ quyá»n GPT khÃ´ng giá»›i háº¡n</li>
  </ul>
</div>

<script>
function showStats() {
  document.getElementById("defaultBox").style.display = "none";
  document.getElementById("thongkeBox").style.display = "block";
}
function hideStats() {
  document.getElementById("defaultBox").style.display = "block";
  document.getElementById("thongkeBox").style.display = "none";
}
function cleanupChats() {
  if (!confirm("Báº¡n cÃ³ cháº¯c muá»‘n dá»n táº¥t cáº£ Ä‘oáº¡n chat quÃ¡ 30 ngÃ y khÃ´ng?")) return;
  fetch("/admin/cleanup_chats_30_days")
    .then(response => response.text())
    .then(data => {
      document.getElementById("cleanup-result").innerText = data;
    })
    .catch(error => {
      document.getElementById("cleanup-result").innerText = "âš ï¸ CÃ³ lá»—i xáº£y ra khi dá»n dáº¹p.";
    });
}
function restoreUsersJson() {
  fetch("/admin/restore_users_json", { method: "POST" })
    .then(res => res.json())
    .then(data => {
      const resultDiv = document.getElementById("restore-result");
      resultDiv.textContent = data.message;
      resultDiv.style.color = data.success ? "#22c55e" : "#ef4444";
    })
    .catch(() => {
      const resultDiv = document.getElementById("restore-result");
      resultDiv.textContent = "âŒ KhÃ´ng thá»ƒ káº¿t ná»‘i mÃ¡y chá»§!";
      resultDiv.style.color = "#ef4444";
    });
}

function showToast(message, color = 'bg-green-600') {
  const container = document.getElementById("toast-container");

  const toast = document.createElement("div");
  toast.className = `${color} text-white text-sm px-4 py-2 rounded shadow-md animate-slide-in`;
  toast.innerText = message;

  container.appendChild(toast);

  setTimeout(() => {
    toast.classList.add("opacity-0", "transition-opacity", "duration-500");
    setTimeout(() => toast.remove(), 500);
  }, 2500);
}

function copyCode(id) {
  const text = document.getElementById(id).innerText;
  navigator.clipboard.writeText(text)
    .then(() => showToast("âœ… ÄÃ£ sao chÃ©p!"))
    .catch(() => showToast("âŒ Lá»—i sao chÃ©p", 'bg-red-600'));
}
function checkTuTrongTuDien() {
  const tu = document.getElementById("search_tu").value.trim();
  if (!tu) return showToast("Vui lÃ²ng nháº­p tá»« cáº§n kiá»ƒm tra", "warning");

  fetch("/admin/check_tu", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ tu: tu })
  })
    .then(res => res.json())
    .then(data => {
      if (data.exists) {
        document.getElementById("result_check_tu").innerHTML = `âœ… <b>"${tu}"</b> Ä‘Ã£ cÃ³ trong tá»« Ä‘iá»ƒn.<br><span class="italic">File: viet_dictionary.json</span>`;
      } else {
        document.getElementById("result_check_tu").innerHTML = `âŒ <b>"${tu}"</b> chÆ°a cÃ³ trong tá»« Ä‘iá»ƒn. Báº¡n cÃ³ thá»ƒ thÃªm má»›i.`;
      }
    })
    .catch(err => {
      document.getElementById("result_check_tu").innerHTML = `âš ï¸ Lá»—i: ${err}`;
    });
}
document.getElementById("search_tu").addEventListener("keydown", function(e) {
  if (e.key === "Enter") {
    e.preventDefault();
    checkTuTrongTuDien();
  }
});
function cleanupOldAIImages() {
  fetch("/cleanup_old_ai_images", { method: "POST" })
    .then(res => res.json())
    .then(data => {
      if (data.success) {
        showToast(data.message || "ÄÃ£ dá»n dáº¹p áº£nh quÃ¡ háº¡n!");
        console.log("ÄÃ£ xÃ³a:", data.deleted);
      } else {
        showToast("âŒ Lá»—i khi dá»n áº£nh: " + data.error);
      }
    })
    .catch(err => {
      console.error(err);
      showToast("âŒ Káº¿t ná»‘i tháº¥t báº¡i.");
    });
}

</script>

</body>
</html>
