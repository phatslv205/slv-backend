<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>N√¢ng c·∫•p g√≥i AI - 3 B∆∞·ªõc</title>
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='logos/favicon.png') }}">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: linear-gradient(to bottom right, #0f2027, #203a43, #2c5364);
      color: white;
    }
    .brand {
      text-align: center;
      font-size: 24px;
      font-weight: bold;
      padding: 20px 0;
      background: #001f3f;
      color: #4ea6ff;
      letter-spacing: 1px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px 32px;
    }
    .brand a {
      color: #4ea6ff;
      text-decoration: none;
      font-size: 14px;
      border: 1px solid #4ea6ff;
      padding: 4px 10px;
      border-radius: 6px;
    }
    .step-container {
      display: flex;
      justify-content: center;
      padding: 40px 20px;
      gap: 40px;
    }
    .step-box {
      width: 320px;
      background: #111;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      opacity: 0.4;
      pointer-events: none;
      position: relative;
      transition: all 0.3s ease;
      border: 2px solid transparent;
    }
    .step-box.active {
      opacity: 1;
      pointer-events: auto;
      border: 2px solid #4ea6ff;
    }
    .step-box.done::after {
      content: "\2714";
      position: absolute;
      top: 10px;
      right: 10px;
      font-size: 24px;
      color: #00e676;
    }
    .step-title {
      font-weight: bold;
      font-size: 18px;
      margin-bottom: 16px;
    }
    .btn {
      margin-top: 20px;
      padding: 10px 20px;
      font-size: 16px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    .btn-primary {
      background: #007bff;
      color: white;
    }
    .btn-outline {
      background: transparent;
      color: #4ea6ff;
      border: 1px solid #4ea6ff;
      margin-right: 10px;
    }
    .loading-overlay {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.4);
      justify-content: center;
      align-items: center;
      z-index: 999;
      color: white;
      font-size: 24px;
    }
    .package-option, .wallet-option {
      display: block;
      margin-bottom: 10px;
      padding: 10px;
      border: 1px solid #666;
      border-radius: 8px;
      cursor: pointer;
      background: #222;
    }
    .package-option.selected,
    .wallet-option.selected {
      background: #004080;
      border-color: #4ea6ff;
    }
    input {
      background: #333;
      border: 1px solid #555;
      color: white;
      width: 100%;
      padding: 8px;
      margin-bottom: 10px;
      border-radius: 6px;
    }
    .note {
      font-size: 14px;
      color: #aaa;
      margin-bottom: 10px;
    }
    .payment-type-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 12px;
        justify-items: center;
        margin: 16px 0;
      }

      .square-btn {
        width: 120px;
        height: 100px;
        font-size: 18px;
        border: 1px solid #4ea6ff;
        background: transparent;
        color: #4ea6ff;
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .square-btn:hover {
        background: #004080;
        color: white;
      }
      .wallet-icon {
        width: 22px;
        height: 22px;
        object-fit: contain;
      }
      html, body {
        height: 100%;
        display: flex;
        flex-direction: column;
      }
      main {
        flex: 1;
      }
      .btn-action {
        background-color: #4ea6ff;
        color: white;
        padding: 10px 18px;
        border: none;
        border-radius: 8px;
        font-size: 15px;
        cursor: pointer;
        transition: background-color 0.3s ease;
        margin-top: 10px;
      }

      .btn-action:hover {
        background-color: #007bff;
      }

      .btn-secondary {
        background-color: #444;
        color: #eee;
        padding: 8px 14px;
        border: none;
        border-radius: 6px;
        font-size: 14px;
        cursor: pointer;
        margin-top: 10px;
        transition: background 0.3s ease;
      }

      .btn-secondary:hover {
        background-color: #666;
      }
      button {
        background-color: #007bff;
        color: white;
        border: none;
        border-radius: 8px;
        padding: 8px 20px;
        transition: background 0.2s ease;
      }
      button:hover {
        background-color: #0056b3;
      }


  </style>
<style>
  @keyframes spin-ring {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }

  @keyframes popup-slide {
    0% { transform: translate(-50%, -60%) scale(0.9); opacity: 0; }
    100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
  }

  .success-popup {
    background: #101c2b;
    color: #fff;
    padding: 28px 30px 22px;
    border-radius: 18px;
    position: fixed;
    top: 30%;
    left: 50%;
    transform: translate(-50%, -50%);
    animation: popup-slide 0.4s ease-out;
    z-index: 10000;
    text-align: center;
    max-width: 400px;
    border: 2px solid #00e676;
    box-shadow: 0 0 22px rgba(0, 230, 118, 0.4);
    font-size: 15px;
  }

  .success-popup .circle {
    width: 64px;
    height: 64px;
    margin: 0 auto 16px;
    position: relative;
  }

  .success-popup .svg-loader {
    width: 64px;
    height: 64px;
    animation: spin-ring 1s linear forwards;
    transform-origin: center;
  }

  .success-popup .icon {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 28px;
    color: #00e676;
    opacity: 0;
    transition: opacity 0.3s ease;
  }

  .success-popup p {
    margin: 12px 0 0;
    font-size: 15px;
    color: #eee;
  }

  .success-popup button {
    margin-top: 16px;
    background: #333;
    color: #eee;
    padding: 8px 18px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    transition: background 0.3s ease;
  }

  .success-popup button:hover {
    background: #555;
  }
  .error-popup {
    background: #2d1a1a;
    color: #fff;
    padding: 24px 28px;
    border-radius: 16px;
    position: fixed;
    top: 30%;
    left: 50%;
    transform: translate(-50%, -50%);
    animation: popup-slide 0.3s ease-out;
    z-index: 10000;
    text-align: center;
    max-width: 380px;
    border: 2px solid #ff4d4d;
    box-shadow: 0 0 22px rgba(255, 77, 77, 0.4);
    font-size: 15px;
  }

  .error-popup .icon {
    font-size: 32px;
    margin-bottom: 10px;
    color: #ff4d4d;
  }

  .error-popup p {
    margin: 0;
    font-size: 15px;
    color: #eee;
  }

</style>


</head>
<body>

<div style="background-color: #0c0c0c; padding: 18px 30px; display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid #2196f3;">
  <div>
    <div style="font-size: 22px; font-weight: bold; color: #4ea6ff;">SolverViet</div>
    <div style="font-size: 12px; color: #999;">¬© 2025. All rights reserved.</div>
  </div>
  <a href="/" style="color: #4ea6ff; text-decoration: none; font-size: 15px;">V·ªÅ trang ch·ªß</a>
</div>


   <main>
  <div class="loading-overlay" id="loading">ƒêang ki·ªÉm tra th√¥ng tin...</div>

  <div class="step-container">

    <div class="step-box active" id="step1">
      <div class="step-title">B∆∞·ªõc 1: Th√¥ng tin t√†i kho·∫£n</div>
      <div class="note">Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß h·ªç t√™n v√† ID c·ªßa b·∫°n ƒë·ªÉ b·∫Øt ƒë·∫ßu quy tr√¨nh n√¢ng c·∫•p.</div>
      <input type="text" id="input-username" placeholder="T√™n t√†i kho·∫£n" value="{{ fullname }}">
      <input type="text" id="input-userid" placeholder="ID ng∆∞·ªùi d√πng" value="{{ user_id }}">
      <button class="btn btn-primary" onclick="submitStep1()">Ti·∫øp t·ª•c</button>
      <div id="step1-error" style="color: #ff6666; margin-top: 10px; display: none;"></div>
    </div>

    <div class="step-box" id="step2">
      <input type="hidden" id="paypal-package" value="">
      <input type="hidden" id="paypal-userid" value="{{ user_id }}">
      <div class="step-title">B∆∞·ªõc 2: Ch·ªçn g√≥i</div>
      <div onclick="selectPackage(this, 'vip_gpt_5d', 49000, 'SLV 5 ng√†y')" class="package-option">SLV5day - 49.000ƒë</div>
    <div onclick="selectPackage(this, 'vip_gpt_15d', 109000, 'SLV 15 ng√†y')" class="package-option">SLV15day - 109.000ƒë</div>
    <div onclick="selectPackage(this, 'vip_gpt_30d', 149000, 'SLV 30 ng√†y')" class="package-option">SLV30day - 149.000ƒë</div>
    <div onclick="selectPackage(this, 'vip_ai_lite', 25000, 'Lite 7 ng√†y')" class="package-option">Lite7day - 25.000ƒë</div>


      <div>
        <button class="btn btn-outline" onclick="goBackToStep(1)">Quay l·∫°i</button>
        <button class="btn btn-primary" onclick="submitStep2()">Ti·∫øp t·ª•c</button>
      </div>
    </div>

    <!-- C·∫≠p nh·∫≠t ph·∫ßn B∆∞·ªõc 3: Thay v√¨ hi·ªán tr·ª±c ti·∫øp c√°c n·ªÅn t·∫£ng thanh to√°n -->
<!-- C·∫≠p nh·∫≠t ph·∫ßn B∆∞·ªõc 3: Thay v√¨ hi·ªán tr·ª±c ti·∫øp c√°c n·ªÅn t·∫£ng thanh to√°n -->
    <div class="step-box" id="step3">
      <div class="step-title">B∆∞·ªõc 3: Thanh to√°n</div>
      <div class="note">Ch·ªçn h√¨nh th·ª©c thanh to√°n b·∫°n mu·ªën s·ª≠ d·ª•ng:</div>

    <div id="main-methods" class="payment-type-grid">
      <button class="square-btn" onclick="showPaymentOptions('qr')">QR</button>
      <button class="square-btn" onclick="showPaymentOptions('stk')">STK</button>
      <button class="square-btn" onclick="showPaymentOptions('atm')">ATM</button>
      <button class="square-btn" onclick="showPaymentOptions('visa')">Visa</button>
    </div>
  <div id="visa-options" style="display: none; margin-top: 20px;">
  <div class="wallet-option" onclick="redirectToPayPal()">
    <img src="/static/logos/paypal_logo.png" class="wallet-icon">
    <span>PayPal</span>
  </div>
  <div class="wallet-option" onclick="selectVisaMethod('visa')">
    <img src="/static/logos/visa_logo.png" class="wallet-icon">
    <span>Visa / MasterCard</span>
  </div>
</div>


  <!-- Kh·ªëi n·ªÅn t·∫£ng cho QR -->
 <div id="qr-options" style="display: none;">
  <div class="wallet-option" onclick="selectWallet(this, 'MoMo')">
    <img src="/static/logos/momo_logo.png" class="wallet-icon">
    <span>MoMo</span>
  </div>

  <div class="wallet-option" onclick="selectWallet(this, 'ZaloPay')">
    <img src="/static/logos/zalopay_logo.png" class="wallet-icon">
    <span>ZaloPay</span>
  </div>

  <div class="wallet-option" onclick="selectWallet(this, 'BIDV')">
    <img src="/static/logos/bidv_logo.png" class="wallet-icon">
    <span>BIDV</span>
  </div>

  <div class="wallet-option" onclick="selectWallet(this, 'MB')">
    <img src="/static/logos/mb_logo.png" class="wallet-icon">
    <span>MB</span>
  </div>

  <div class="wallet-option" onclick="selectWallet(this, 'VCB')">
    <img src="/static/logos/vcb_logo.jpg" class="wallet-icon">
    <span>Vietcombank</span>
  </div>

  <div class="wallet-option" onclick="selectWallet(this, 'ARIBANK')">
    <img src="/static/logos/ari_logo.png" class="wallet-icon">
    <span>Agribank</span>
  </div>

  <div class="wallet-option" onclick="selectWallet(this, 'CAKE')">
    <img src="/static/logos/cake_logo.png" class="wallet-icon">
    <span>Cake Bank</span>
  </div>
</div>

<div id="popup-step3-stk" class="popup" style="display: none;">
  <div class="wallets">
    <div class="wallet-option" onclick="selectSTKPlatform(this, 'MB')">
      <img src="/static/logos/mb_logo.png" class="wallet-icon">
      <span>MB</span>
    </div>

    <div class="wallet-option" onclick="selectSTKPlatform(this, 'VCB')">
      <img src="/static/logos/vcb_logo.jpg" class="wallet-icon">
      <span>Vietcombank</span>
    </div>

    <div class="wallet-option" onclick="selectSTKPlatform(this, 'BIDV')">
      <img src="/static/logos/bidv_logo.png" class="wallet-icon">
      <span>BIDV</span>
    </div>

    <div class="wallet-option" onclick="selectSTKPlatform(this, 'ARIBANK')">
      <img src="/static/logos/ari_logo.png" class="wallet-icon">
      <span>Agribank</span>
    </div>

    <div class="wallet-option" onclick="selectSTKPlatform(this, 'ZaloPay')">
      <img src="/static/logos/zalopay_logo.png" class="wallet-icon">
      <span>ZaloPay</span>
    </div>

    <div class="wallet-option" onclick="selectSTKPlatform(this, 'MoMo')">
      <img src="/static/logos/momo_logo.png" class="wallet-icon">
      <span>MoMo</span>
    </div>

    <div class="wallet-option" onclick="selectSTKPlatform(this, 'CAKE')">
      <img src="/static/logos/cake_logo.png" class="wallet-icon">
      <span>Cake Bank</span>
    </div>
  </div>
</div>
  <!-- N√∫t ƒëi·ªÅu h∆∞·ªõng -->
  <div style="margin-top: 20px">
    <button class="btn btn-outline" onclick="customBack()">Quay l·∫°i</button>

    <button class="btn btn-primary" id="pay-now-btn" style="display: none" onclick="finalRedirect()">Thanh to√°n ngay</button>
  </div>
</div>

<!-- Loading khi t·∫°o m√£ QR -->
<div class="loading-overlay" id="qr-loading" style="display: none;">
  ƒêang t·∫°o m√£ QR...
</div>

<!-- Popup QR hi·ªán ra sau khi ch·ªçn n·ªÅn t·∫£ng QR -->
<div id="qr-popup" style="display: none; text-align: center; margin-top: 40px;">
  <div style="background: #111; border-radius: 12px; padding: 20px; width: 340px; margin: auto; border: 2px solid #4ea6ff;">
    <div style="font-size: 18px; font-weight: bold; margin-bottom: 10px;">M√£ QR thanh to√°n</div>

    <img id="qr-image" src="" width="260" height="260" style="margin-bottom: 10px;" />

    <div id="qr-info" style="font-size: 14px; color: #aaa; margin-bottom: 10px;"></div>
    <div id="qr-warning" style="font-size: 13px; color: #ffcc00;"></div>

    <button id="copy-qr-txn-btn"
          onclick="copyQRTransaction()"
          class="btn-secondary"
          style="display: none;">
     Sao ch√©p m√£ giao d·ªãch
  </button>


    <!-- N√∫t ho√†n t·∫•t -->
<form id="upgrade-form">
  <input id="input-package" name="package" type="hidden">
  <input id="input-note" name="note" type="hidden">
  <input id="input-method" name="method" type="hidden">
  <button type="button" class="btn-action" onclick="finishTransaction()"> Ho√†n t·∫•t</button>
</form>
   <p style="font-size: 13px; color: #888; margin-top: 10px; text-align: center;">
‚ö†Ô∏è N·∫øu ƒë√£ thanh to√°n m√† b·∫°n ch∆∞a c√≥ VIP, vui l√≤ng 
<a href="/feedback" style="color: #4ea6ff; text-decoration: underline;">li√™n h·ªá nh√† ph√°t tri·ªÉn</a> ƒë·ªÉ ƒë∆∞·ª£c h·ªó tr·ª£ nhanh ch√≥ng.<br>
N√™n <b>ch·ª•p l·∫°i h√≥a ƒë∆°n thanh to√°n</b> ƒë·ªÉ x√°c minh thu·∫≠n ti·ªán h∆°n nh√©!
</p>

  </div>
</div>


<!-- Popup STK hi·ªán ra sau khi ch·ªçn n·ªÅn t·∫£ng STK -->
<div id="stk-popup" style="display: none; text-align: center; margin-top: 40px;">
  <div style="
      background: #182b3a;
      border-radius: 16px;
      padding: 24px;
      width: 360px;
      margin: auto;
      border: 2px solid #4ea6ff;
      box-shadow: 0 0 20px rgba(78, 166, 255, 0.3);
      font-size: 15px;
      line-height: 1.6;
    ">
    <div style="font-size: 20px; font-weight: bold; margin-bottom: 16px; color: #4ea6ff;">
       Th√¥ng tin chuy·ªÉn kho·∫£n
    </div>

    <div style="text-align: left;">
      <p><strong>S·ªë t√†i kho·∫£n:</strong> <span id="stk-account">...</span></p>
      <button onclick="copyToClipboard('stk-account', 's·ªë t√†i kho·∫£n')">üìã Sao ch√©p s·ªë t√†i kho·∫£n</button>

      <p><strong>T√™n t√†i kho·∫£n:</strong> <span id="stk-name">TRAN HONG PHAT</span></p>
      <p><strong>T√™n ng∆∞·ªùi d√πng:</strong> <span id="stk-username">...</span></p>
      <p><strong>ID:</strong> <span id="stk-userid">...</span></p>
      <p><strong>G√≥i:</strong> <span id="stk-package">...</span></p>
      <p><strong>M√£ giao d·ªãch:</strong> <span id="stk-txn">...</span></p>
      <p><strong>H·∫øt h·∫°n trong:</strong> <span id="stk-countdown">14:59</span></p>
    </div>

    <p style="font-size: 13px; color: #ffc107; background: #2d3f52; padding: 8px; border-radius: 8px; margin-top: 12px;">
      ‚ö†Ô∏è Vui l√≤ng sao ch√©p m√£ giao d·ªãch d√°n v√†o ƒë√∫ng n·ªôi dung chuy·ªÉn kho·∫£n.
    </p>

    <button onclick="copyToClipboard('stk-txn', 'm√£ giao d·ªãch')">üìã Sao ch√©p m√£</button>

    <!-- ‚úÖ N√∫t ho√†n t·∫•t STK -->
    <form id="upgrade-form-stk">
      <input id="input-package-stk" name="package" type="hidden">
      <input id="input-note-stk" name="note" type="hidden">
      <input id="input-method-stk" name="method" type="hidden">
      <button type="button" class="btn-action" onclick="finishTransactionSTK()"> Ho√†n t·∫•t</button>
    </form>
    <p style="font-size: 13px; color: #888; margin-top: 10px; text-align: center;">
      ‚ö†Ô∏è N·∫øu ƒë√£ thanh to√°n m√† b·∫°n ch∆∞a c√≥ VIP, vui l√≤ng 
      <a href="/feedback" style="color: #4ea6ff; text-decoration: underline;">li√™n h·ªá nh√† ph√°t tri·ªÉn</a> ƒë·ªÉ ƒë∆∞·ª£c h·ªó tr·ª£ nhanh ch√≥ng.<br>
      N√™n <b>ch·ª•p l·∫°i h√≥a ƒë∆°n thanh to√°n</b> ƒë·ªÉ x√°c minh thu·∫≠n ti·ªán h∆°n nh√©!
      </p>

  </div>
</div>

  </div>
</div>
<div id="atm-coming-popup" style="display: none; text-align: center; margin-top: 40px;">
  <div style="
      background: #332222;
      border-radius: 16px;
      padding: 24px;
      width: 360px;
      margin: auto;
      border: 2px solid #ff9900;
      box-shadow: 0 0 20px rgba(255, 166, 0, 0.3);
      font-size: 15px;
      line-height: 1.6;
      color: #ffcc99;
    ">
    <div style="font-size: 20px; font-weight: bold; margin-bottom: 16px; color: #ff9900;">
       üöß T√≠nh nƒÉng ƒëang ph√°t tri·ªÉn
    </div>
    <div>
      Hi·ªán t·∫°i ph∆∞∆°ng th·ª©c <b>Thanh to√°n b·∫±ng ATM</b> ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn.<br>
      R·∫•t mong b·∫°n th√¥ng c·∫£m. Ch√¢n th√†nh xin l·ªói b·∫°n v√¨ s·ª± b·∫•t ti·ªán n√†y!. 
    </div>
  </div>
</div>
<!-- Popup Visa/MasterCard ƒëang ph√°t tri·ªÉn -->
<div id="visa-coming-popup" style="display: none; text-align: center; margin-top: 40px;">
  <div style="
      background: #222233;
      border-radius: 16px;
      padding: 24px;
      width: 360px;
      margin: auto;
      border: 2px solid #ff66cc;
      box-shadow: 0 0 20px rgba(255, 105, 180, 0.3);
      font-size: 15px;
      line-height: 1.6;
      color: #ffcce0;
    ">
    <div style="font-size: 20px; font-weight: bold; margin-bottom: 16px; color: #ff66cc;">
        T√≠nh nƒÉng ƒëang ph√°t tri·ªÉn
    </div>
    <div>
      Ph∆∞∆°ng th·ª©c <b>Visa / MasterCard</b> hi·ªán ch∆∞a kh·∫£ d·ª•ng.<br>
      Vui l√≤ng ch·ªçn <b>PayPal</b> ho·∫∑c ph∆∞∆°ng th·ª©c kh√°c ƒë·ªÉ ti·∫øp t·ª•c.
    </div>
  </div>
</div>
</main>

  <script>
    let paymentMode = null;
    const loading = document.getElementById('loading');
    let selectedPackage = null;
    let selectedWallet = null;
    let currentSTKPlatform = null;
    let savedFullname = "";
    let savedUserId = "";

    function submitStep1() {
      const name = document.getElementById('fullname').value.trim();
      const id = document.getElementById('userId').value.trim();
      if (!name || !id) return alert('Vui l√≤ng nh·∫≠p ƒë·ªß h·ªç t√™n v√† ID.');
      savedFullname = name;
      savedUserId = id;
      loading.style.display = 'flex';

      setTimeout(() => {
        loading.style.display = 'none';
        markStepDone(1);
        enableStep(2);
      }, 1500);
    }

    function submitStep2() {
      if (!selectedPackage) {
        showToast(" B·∫°n ch∆∞a ch·ªçn g√≥i n√¢ng c·∫•p n√†o. Vui l√≤ng ch·ªçn tr∆∞·ªõc khi ti·∫øp t·ª•c.");
        return;
      }
      markStepDone(2);
      enableStep(3);
      document.getElementById("paypal-package").value = selectedPackage[0]; 
    }

 

    function markStepDone(step) {
      document.getElementById('step' + step).classList.remove('active');
      document.getElementById('step' + step).classList.add('done');
    }

    function enableStep(step) {
      document.getElementById('step' + step).classList.add('active');
    }

    function goBackToStep(step) {
      document.querySelectorAll('.step-box').forEach(b => b.classList.remove('active'));
      document.getElementById('step' + step).classList.add('active');
    }

    function selectPackage(el, code, price, displayName) {
      document.querySelectorAll('.package-option').forEach(p => p.classList.remove('selected'));
      el.classList.add('selected');
      selectedPackage = [code, price, displayName];
    }


    function selectWallet(el, method) {
      // 1. Hi·ªán loading ngay l·∫≠p t·ª©c
      document.getElementById("qr-popup").style.display = "none";
      document.getElementById("qr-loading").style.display = "flex";
      document.getElementById("qr-warning").innerText = "";
      document.getElementById("qr-info").innerText = "";

      // 2. Giao di·ªán ch·ªçn n·ªÅn t·∫£ng
      document.querySelectorAll('.wallet-option').forEach(p => p.classList.remove('selected'));
      el.classList.add('selected');
      selectedWallet = method;

      // 3. T·∫°o l·∫°i m√£ QR
      if (paymentMode === 'qr') {
        showQRPopup(method);
      }
    }


    window.onload = () => {
        const fullname = "{{ fullname|default('') }}";
        const userId = "{{ user_id|default('') }}";

        const fullnameInput = document.getElementById('fullname');
        const userIdInput = document.getElementById('userId');

        if (fullnameInput) fullnameInput.value = fullname;
        if (userIdInput) userIdInput.value = userId;
      };


      function showPaymentOptions(method) {
        const payNowBtn = document.getElementById("pay-now-btn");
        const qrOptions = document.getElementById("qr-options");
        const mainMethods = document.getElementById("main-methods");
        const stkPopup = document.getElementById("popup-step3-stk");
        const atmComingPopup = document.getElementById("atm-coming-popup");
        const visaComingPopup = document.getElementById("visa-coming-popup");

        // ·∫®n t·∫•t c·∫£ popup/ph·ª•
        qrOptions.style.display = "none";
        stkPopup.style.display = "none";
        atmComingPopup.style.display = "none";
        visaComingPopup.style.display = "none";

        // ·∫®n n√∫t thanh to√°n ngay m·∫∑c ƒë·ªãnh
        payNowBtn.style.display = "none";

        // L∆∞u tr·∫°ng th√°i
        paymentMode = method;

        if (method === "qr") {
          qrOptions.style.display = "block";
          mainMethods.style.display = "none";
        } else if (method === "stk") {
          stkPopup.style.display = "block";
          mainMethods.style.display = "none";
        } else if (method === "atm") {
          mainMethods.style.display = "none";
          atmComingPopup.style.display = "block";
        }else if (method === "visa") {
          mainMethods.style.display = "none";
          document.getElementById("visa-options").style.display = "block";
        }else if (method === "paypal") {
          redirectToPayPal(); // üëà b·∫°n ph·∫£i c√≥ h√†m n√†y
        } else {
          goBackToStep(2);
          if (savedFullname) document.getElementById('fullname').value = savedFullname;
          if (savedUserId) document.getElementById('userId').value = savedUserId;
        }
      }


function customBack() {
  const mainMethods = document.getElementById("main-methods");
  const qrOptions = document.getElementById("qr-options");
  const qrPopup = document.getElementById("qr-popup");
  const stkPopup = document.getElementById("stk-popup");
  const popupSTK = document.getElementById("popup-step3-stk");
  const atmComingPopup = document.getElementById("atm-coming-popup");
  const visaOptions = document.getElementById("visa-options");
  const visaComingPopup = document.getElementById("visa-coming-popup");

  if (paymentMode === "qr") {
    qrPopup.style.display = "none";
    qrOptions.style.display = "none";
    mainMethods.style.display = "grid";
    paymentMode = null;
    selectedWallet = null;
  } else if (paymentMode === "stk") {
    stkPopup.style.display = "none";
    popupSTK.style.display = "none";
    mainMethods.style.display = "grid";
    paymentMode = null;
    currentSTKPlatform = null;
    clearInterval(stkCountdown);
  } else if (paymentMode === "atm") {
    atmComingPopup.style.display = "none";
    mainMethods.style.display = "grid";
    paymentMode = null;
  } else if (paymentMode === "visa") {
    visaOptions.style.display = "none";
    visaComingPopup.style.display = "none";
    mainMethods.style.display = "grid";
    paymentMode = null;
  } else {
    goBackToStep(2);
  }
}



function showQRPopup(method) {
  if (!selectedPackage) {
    alert("‚ùå B·∫°n ch∆∞a ch·ªçn g√≥i n√¢ng c·∫•p.");
    document.getElementById("qr-loading").style.display = "none";
    return;
  }

  const [pkgCode, price, displayName] = selectedPackage;
  const name = document.getElementById('input-username').value.trim();
  const id = document.getElementById('input-userid').value.trim();
  const txn = 'TXN_' + Math.random().toString(36).substring(2, 8).toUpperCase();
  const shortId = id.substring(0, 8);

  let content = `${displayName}|tk:${name}|ID:${shortId}|mgd:${txn}`;
  let displayContent = content;
  let warningMsg = "";

  if (["MoMo", "ZaloPay"].includes(method)) {
    content = txn;
    displayContent = `M√£ giao d·ªãch: ${txn}`;
    warningMsg = "‚ö†Ô∏è Khi thanh to√°n b·∫±ng m√£ QR MoMo ho·∫∑c ZaloPay, vui l√≤ng nh·∫≠p ch√≠nh x√°c m√£ giao d·ªãch trong ph·∫ßn n·ªôi dung chuy·ªÉn kho·∫£n.";
  }

  document.getElementById("qr-loading").style.display = "flex";

  setTimeout(() => {
    document.getElementById("qr-loading").style.display = "none";
    document.getElementById("qr-popup").style.display = "block";

    const finishBtn = document.getElementById("finish-btn");
    if (finishBtn) finishBtn.style.display = "inline-block";

    document.getElementById("qr-info").innerText = displayContent;
    document.getElementById("qr-warning").innerText = warningMsg;
    window.qrCopyContent = content;

    const copyBtn = document.getElementById("copy-qr-txn-btn");
    if (["MoMo", "ZaloPay"].includes(method)) {
      if (copyBtn) copyBtn.style.display = "inline-block";
    } else {
      if (copyBtn) copyBtn.style.display = "none";
    }

    const accountMap = {
      MB: ["970422", "0865645752"],
      BIDV: ["970418", "7351445220"],
      VCB: ["970436", "1057958336"],
      ARIBANK: ["970405", "7406281009097"],
      CAKE: ["CAKE", "0865645752"],
    };

    let qrURL = "";
    if (["MoMo", "ZaloPay"].includes(method)) {
      qrURL = `/static/qrcodes/${method.toLowerCase()}.png`;
    } else {
      const [bankCode, accountNumber] = accountMap[method];
      qrURL = `https://img.vietqr.io/image/${bankCode}-${accountNumber}-compact.png?amount=${price}&addInfo=${encodeURIComponent(content)}`;
    }

    document.getElementById("qr-image").src = qrURL;
  }, 1500);
}

function selectSTKPlatform(el, platform) {
  if (platform !== currentSTKPlatform) {
    // ‚ùó Ch·ªâ ·∫©n popup chuy·ªÉn kho·∫£n STK, KH√îNG ·∫©n popup b∆∞·ªõc 3
    document.getElementById("stk-popup").style.display = "none";

    // ‚è≥ Hi·ªán loading
    showFullscreenLoading("ƒêang t·∫°o m√£ giao d·ªãch...");

    setTimeout(() => {
      currentSTKPlatform = platform;
      document.querySelectorAll('#popup-step3-stk .wallet-option').forEach(p => p.classList.remove('selected'));
      el.classList.add('selected');
      hideFullscreenLoading();

      const username = savedFullname;
      const userId = savedUserId;

      if (!username || !userId) {
        alert("‚ö†Ô∏è Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß t√™n v√† ID ·ªü B∆∞·ªõc 1.");
        return;
      }

      if (!selectedPackage) {
        alert("‚ö†Ô∏è Vui l√≤ng ch·ªçn g√≥i ·ªü B∆∞·ªõc 2.");
        return;
      }

      console.log("‚úÖ G·ªçi showSTKPopup v·ªõi:", platform, selectedPackage, userId, username);
      showSTKPopup(platform, selectedPackage, userId, username);
    }, 1200);
  }
}




let stkCountdown;
function showSTKPopup(platform, selectedPackage, userId, username) {
  const popup = document.getElementById("stk-popup");
  if (!popup) {
    console.error("‚ùå Kh√¥ng t√¨m th·∫•y ph·∫ßn t·ª≠ stk-popup");
    return;
  }

  popup.style.display = "block";  // ‚úÖ ƒê·∫£m b·∫£o hi·ªÉn th·ªã popup

  const txn = 'TXN_' + Math.random().toString(36).substring(2, 8).toUpperCase();

  const accountMap = {
    MB: "0865645752",
    VCB: "1057958336",
    BIDV: "7351445220",
    ARIBANK: "7406281009097",
    ZaloPay: "0865645752",
    MoMo: "0865645752",
    CAKE: "0865645752"
  };

  const account = accountMap[platform] || "0000000000";

  document.getElementById("stk-account").innerText = account;
  document.getElementById("stk-name").innerText = "TRAN HONG PHAT";
  document.getElementById("stk-username").innerText = username || "(Kh√¥ng c√≥)";
  document.getElementById("stk-userid").innerText = userId || "(Kh√¥ng c√≥)";
  document.getElementById("stk-package").innerText = selectedPackage?.[2] || "(Kh√¥ng r√µ)";
  document.getElementById("stk-txn").innerText = txn;

  window.stkTxn = txn;
  startSTKCountdown(14 * 60 + 59);
}



function startSTKCountdown(seconds) {
  clearInterval(stkCountdown);
  stkCountdown = setInterval(() => {
    const m = Math.floor(seconds / 60);
    const s = seconds % 60;
    document.getElementById("stk-countdown").innerText = `${m}:${s.toString().padStart(2, '0')}`;
    if (--seconds < 0) {
      clearInterval(stkCountdown);
      document.getElementById("stk-countdown").innerText = "‚õî ƒê√£ h·∫øt h·∫°n";
    }
  }, 1000);
}

function closeSTKPopup() {
  document.getElementById("stk-popup").style.display = "none";
  clearInterval(stkCountdown);
}
function copyToClipboard(elementId, label = "n·ªôi dung") {
  const content = document.getElementById(elementId)?.innerText;
  if (!content) {
    showToast(`‚ö†Ô∏è Kh√¥ng t√¨m th·∫•y ${label} ƒë·ªÉ sao ch√©p.`);
    return;
  }

  navigator.clipboard.writeText(content).then(() => {
    showToast(`üìã ƒê√£ sao ch√©p ${label}!`);
  }).catch(() => {
    showToast(`‚ùå Kh√¥ng th·ªÉ sao ch√©p ${label}.`);
  });
}

function copyContentSTK() {
  const txn = document.getElementById("stk-txn").innerText;
  navigator.clipboard.writeText(txn).then(() => {
    showToast("üìã ƒê√£ sao ch√©p m√£ giao d·ªãch!");
  }).catch(() => {
    showToast("‚ùå Kh√¥ng th·ªÉ sao ch√©p m√£ giao d·ªãch.");
  });
}

function copySTKAccount() {
  const stk = document.getElementById("stk-account").innerText;
  navigator.clipboard.writeText(stk).then(() => {
    alert("üìã ƒê√£ sao ch√©p s·ªë t√†i kho·∫£n: " + stk);
  }).catch(() => {
    alert("‚ùå Kh√¥ng th·ªÉ sao ch√©p s·ªë t√†i kho·∫£n.");
  });
}

function showFullscreenLoading() {
  if (paymentMode === 'stk') {
    document.getElementById("stk-loading").style.display = "flex";
  } else {
    document.getElementById("qr-loading").style.display = "flex";
  }
}

function hideFullscreenLoading() {
  document.getElementById("qr-loading").style.display = "none";
  const stk = document.getElementById("stk-loading");
  if (stk) stk.style.display = "none";
}

function showToast(message) {
  const toast = document.getElementById("toast");
  toast.innerText = message;
  toast.style.display = "block";
  toast.style.opacity = 1;

  setTimeout(() => {
    toast.style.opacity = 0;
    setTimeout(() => {
      toast.style.display = "none";
    }, 400);
  }, 3000);
}
function copyQRTransaction() {
  if (!window.qrCopyContent) return showToast("‚ùå Kh√¥ng c√≥ n·ªôi dung ƒë·ªÉ sao ch√©p.");
  navigator.clipboard.writeText(window.qrCopyContent).then(() => {
    showToast("üìã ƒê√£ sao ch√©p m√£ giao d·ªãch!");
  }).catch(() => {
    showToast("‚ùå Kh√¥ng th·ªÉ sao ch√©p m√£ giao d·ªãch.");
  });
}
function selectVisaMethod(method) {
  if (method === "paypal") {
    redirectToPayPal();
  } else if (method === "visa") {
    document.getElementById("visa-options").style.display = "none";
    document.getElementById("visa-coming-popup").style.display = "block";
  }
}

</script>
<div id="stk-loading" class="loading-overlay" style="display: none;">
  ƒêang t·∫°o m√£ giao d·ªãch...
</div>

<div id="qr-loading" class="loading-overlay" style="display: none;">
  <div class="loading-text">üîÑ ƒêang t·∫°o m√£ QR, vui l√≤ng ƒë·ª£i trong gi√¢y l√°t...</div>
</div>

<div id="toast" style="
  position: fixed;
  bottom: 30px;
  right: 30px;
  background-color: #4ea6ff;
  color: white;
  padding: 12px 18px;
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.2);
  font-size: 14px;
  z-index: 9999;
  display: none;
  opacity: 0;
  transition: opacity 0.4s ease;
"></div>


<!-- ===== Footer H·ªó tr·ª£ SolverViet ===== -->
<div style="margin-top: 80px; text-align: center; color: #ccc; font-size: 14px;">
  <div style="margin-bottom: 8px;">
    <span style="color: #ffcc00;">‚ö†Ô∏è</span> N·∫øu b·∫°n g·∫∑p s·ª± c·ªë ho·∫∑c c·∫ßn tr·ª£ gi√∫p, vui l√≤ng li√™n h·ªá nh√† ph√°t tri·ªÉn SolverViet:
  </div>
  <div style="margin-bottom: 8px;">

  </div>
  <div style="margin-bottom: 6px;">
    <span style="color: #ff6666;">üìû Zalo/ƒêi·ªán tho·∫°i:</span>
    <a href="tel:0865645752" style="color: #4ea6ff;">0865645752</a>
    &nbsp;&nbsp;
    <span style="color: #66ccff;">üìß Email:</span>
    <a href="mailto:solverviet@gmail.com" style="color: #4ea6ff;">solverviet@gmail.com</a>
  </div>
  <div style="font-style: italic; color: #aaa;">Ch√∫ng t√¥i lu√¥n s·∫µn s√†ng h·ªó tr·ª£ b·∫°n!</div>
</div>
<script>
function redirectToPayPal() {
  const packageValue = document.getElementById("paypal-package")?.value;
  const userId = document.getElementById("paypal-userid")?.value;

  if (!packageValue || !userId) {
    alert("‚ö†Ô∏è B·∫°n c·∫ßn ch·ªçn g√≥i v√† nh·∫≠p th√¥ng tin.");
    return;
  }
  console.log("üì¶ G·ª≠i ƒë·∫øn PayPal:", { package: packageValue, user_id: userId });

  fetch("/paypal/start", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      package: packageValue,
      user_id: userId
    })
  })
  .then(async res => {
    if (!res.ok) throw new Error("‚ùå Server tr·∫£ v·ªÅ l·ªói");
    const contentType = res.headers.get("content-type");
    if (!contentType || !contentType.includes("application/json")) {
      throw new Error("‚ùå Server kh√¥ng tr·∫£ JSON");
    }
    return await res.json();
  })

  .then(data => {
    if (data.url) {
      window.location.href = data.url;
    } else {
      alert("‚ùå Kh√¥ng th·ªÉ kh·ªüi t·∫°o thanh to√°n.");
    }
  })
  .catch(err => {
    console.error(err);
    alert("‚ùå L·ªói k·∫øt n·ªëi ƒë·∫øn PayPal: " + err);
  });
}

</script>

<script>
function submitStep1() {
  const name = document.getElementById('input-username').value.trim();
  const id = document.getElementById('input-userid').value.trim();
  const errorBox = document.getElementById("step1-error");

  if (!name || !id) {
    alert('‚ö†Ô∏è Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß t√™n t√†i kho·∫£n v√† ID.');
    return;
  }

  savedFullname = name;
  savedUserId = id;
  loading.style.display = 'flex';
  errorBox.style.display = "none"; // ·∫®n l·ªói c≈© (n·∫øu c√≥)

  fetch('/verify_user_info', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ username: name, user_id: id })
  })
  .then(res => res.json())
  .then(data => {
    setTimeout(() => {
      loading.style.display = 'none';

      if (data.valid) {
        markStepDone(1);
        enableStep(2);
      } else {
        // Hi·ªÉn th·ªã l·ªói ngay b√™n d∆∞·ªõi
        errorBox.innerText = "‚ùå T√†i kho·∫£n ho·∫∑c ID kh√¥ng ƒë√∫ng. Vui l√≤ng ki·ªÉm tra l·∫°i.";
        errorBox.style.display = "block";
      }
    }, 1500); // delay 1.5s ƒë·ªÉ UX m∆∞·ª£t
  })
  .catch(err => {
    setTimeout(() => {
      loading.style.display = 'none';
      alert("‚ùå C√≥ l·ªói x·∫£y ra. Vui l√≤ng th·ª≠ l·∫°i sau.");
      console.error(err);
    }, 1500);
  });
}
function finishTransactionSTK() {
  const pkgCode = selectedPackage?.[0] || "";
  const method = currentSTKPlatform || "";
  const note = window.stkTxn || "";  // M√£ giao d·ªãch

  if (!pkgCode || !method || !note) {
    alert("‚ö†Ô∏è Thi·∫øu th√¥ng tin x√°c th·ª±c.");
    return;
  }

  document.getElementById("input-package-stk").value = pkgCode;
  document.getElementById("input-method-stk").value = method;
  document.getElementById("input-note-stk").value = note;

  document.getElementById("fullscreen-loading").style.display = "flex";

  const formData = new FormData(document.getElementById("upgrade-form-stk"));

  fetch("/upgrade", {
    method: "POST",
    body: formData
  })
  .then(res => res.text())
  .then(html => {
    pollTransactionStatus(); // H√†m n√†y b·∫°n ƒë√£ c√≥, d√πng ƒë·ªÉ check tr·∫°ng th√°i giao d·ªãch
  })
  .catch(err => {
    document.getElementById("fullscreen-loading").style.display = "none";
    alert("‚ùå L·ªói khi g·ª≠i giao d·ªãch.");
    console.error(err);
  });
}

function finishTransaction() {
  const pkgCode = selectedPackage?.[0] || "";
  const method = selectedWallet || "";
  const note = window.qrCopyContent || "";

  if (!pkgCode || !method || !note) {
    alert("‚ö†Ô∏è Thi·∫øu th√¥ng tin x√°c th·ª±c.");
    return;
  }

  document.getElementById("input-package").value = pkgCode;
  document.getElementById("input-method").value = method;
  document.getElementById("input-note").value = note;

  document.getElementById("fullscreen-loading").style.display = "flex";

  const formData = new FormData(document.getElementById("upgrade-form"));

  fetch("/upgrade", {
    method: "POST",
    body: formData
  })
  .then(res => res.text())
  .then(html => {
    pollTransactionStatus(); // G·ªçi check /check_status
  })
  .catch(err => {
    document.getElementById("fullscreen-loading").style.display = "none";
    alert("‚ùå L·ªói khi g·ª≠i giao d·ªãch.");
    console.error(err);
  });
}

function pollTransactionStatus() {
  let retries = 0;
  const interval = setInterval(() => {
    fetch("/check_status")
      .then(res => res.json())
      .then(data => {
        if (!data || !data.status) return;

        if (data.status === "approved") {
          clearInterval(interval);
          document.getElementById("fullscreen-loading").style.display = "none";
          showPopup("‚úÖ Giao d·ªãch th√†nh c√¥ng! B·∫°n s·∫Ω ƒë∆∞·ª£c chuy·ªÉn sang giao di·ªán ch√≠nh sau 5 gi√¢y.", true);
          setTimeout(() => window.location.href = "/", 5000);
        } else if (data.status === "rejected") {
          clearInterval(interval);
          document.getElementById("fullscreen-loading").style.display = "none";
          showPopup(`‚ùå Giao d·ªãch b·ªã t·ª´ ch·ªëi. <a href="/feedback" style="color:#4ea6ff;">Li√™n h·ªá nh√† ph√°t tri·ªÉn t·∫°i ƒë√¢y</a>.`);
        }

        retries++;
        if (retries >= 15) {
          clearInterval(interval);
          document.getElementById("fullscreen-loading").style.display = "none";
          showPopup("‚ùå Qu√° th·ªùi gian x√°c th·ª±c giao d·ªãch. Vui l√≤ng th·ª≠ l·∫°i sau,ho·∫∑c ");
        }
      })
      .catch(err => {
        console.error("L·ªói ki·ªÉm tra tr·∫°ng th√°i:", err);
      });
  }, 3000);
}

function showPopup(msg, allowBack = false) {
  const popup = document.createElement("div");
  const isSuccess = msg.toLowerCase().includes("th√†nh c√¥ng");
  const isError = msg.toLowerCase().includes("t·ª´ ch·ªëi") || msg.toLowerCase().includes("l·ªói");

  // ‚úÖ Popup th√†nh c√¥ng
  if (isSuccess) {
    popup.className = "success-popup";
    popup.innerHTML = `
      <div class="circle">
        <svg class="svg-loader" viewBox="0 0 50 50">
          <circle cx="25" cy="25" r="22" fill="none" stroke="#00e676" stroke-width="4" />
        </svg>
        <div class="icon">üéâ</div>
      </div>
      <p>${msg}</p>
      ${allowBack ? '<button onclick="window.location.href=\'/\'">V·ªÅ trang ch·ªß</button>' : ''}
    `;
    document.body.appendChild(popup);
    setTimeout(() => popup.querySelector('.icon').style.opacity = 1, 1000);
  }

  // ‚ùå Popup l·ªói
  else if (isError) {
    popup.className = "error-popup";
    popup.innerHTML = `
      <div class="icon">‚ùå</div>
      <p>${msg}</p>
    `;
    document.body.appendChild(popup);
  }

  // ·∫®n sau 5s + reload n·∫øu l√† popup l·ªói
  if (!allowBack) {
    setTimeout(() => {
      popup.style.opacity = 0;
      setTimeout(() => {
        popup.remove();
        if (isError) location.reload();
      }, 400);
    }, 5000);
  }
}

</script>
<div id="fullscreen-loading" style="
  display: none;
  position: fixed;
  inset: 0;
  z-index: 9999;
  background: rgba(0,0,0,0.8);
  justify-content: center;
  align-items: center;
  font-size: 18px;
  color: white;">
  ƒêang x√°c th·ª±c giao d·ªãch ( ƒëi·ªÅu n√†y c√≥ th·ªÉ m·∫•t v√†i ph√∫t)...
</div>
<script>
  // üü° Truy·ªÅn t·ª´ Flask
  const hasGPT = {{ 'true' if vip_gpt_active else 'false' }};
  const hasLite = {{ 'true' if vip_lite_active else 'false' }};

  window.onload = () => {
    const fullname = "{{ fullname|default('') }}";
    const userId = "{{ user_id|default('') }}";
    if (fullname && userId) {
      document.getElementById('fullname').value = fullname;
      document.getElementById('userId').value = userId;
    }

    // ‚úÖ Ch·∫∑n ch·ªçn g√≥i n·∫øu ƒëang c√≥ g√≥i kh√°c
    const packageOptions = document.querySelectorAll(".package-option");

    packageOptions.forEach(option => {
      const text = option.innerText.toLowerCase();

      if (hasGPT && text.includes("lite")) {
        option.style.opacity = 0.4;
        option.style.pointerEvents = "none";
      }

      if (hasLite && text.includes("slv")) {
        option.style.opacity = 0.4;
        option.style.pointerEvents = "none";
      }
    });
  };

  // ‚úÖ C·∫£nh b√°o khi c·ªë ch·ªçn g√≥i kh√¥ng h·ª£p l·ªá
   function selectPackage(el, code, price, displayName) {
    // üîí N·∫øu ƒëang c√≥ GPT ‚Üí ch·∫∑n ch·ªçn g√≥i Lite
    if (hasGPT && code === "vip_ai_lite") {
      showToast("üö´ Hi·ªán b·∫°n ƒë√£ s·ªü h·ªØu quy·ªÅn l·ª£i c·ªßa SLV n√™n kh√¥ng th·ªÉ mua g√≥i Lite.");
      return;
    }

    // üîí N·∫øu ƒëang c√≥ Lite ‚Üí ch·∫∑n ch·ªçn g√≥i GPT
    if (hasLite && code.startsWith("vip_gpt")) {
      showToast("üö´ Hi·ªán b·∫°n ƒë√£ s·ªü h·ªØu quy·ªÅn l·ª£i c·ªßa Lite n√™n kh√¥ng th·ªÉ mua g√≥i SLV.");
      return;
    }

    // ‚ö†Ô∏è N·∫øu ƒë√£ c√≥ g√≥i GPT ‚Üí c·∫£nh b√°o ghi ƒë√®
    if (hasGPT && code.startsWith("vip_gpt")) {
      showToast("‚ö†Ô∏è C√¢n nh·∫Øc: G√≥i SLV c·ªßa b·∫°n ch∆∞a h·∫øt h·∫°n. N·∫øu mua th√™m s·∫Ω b·ªã ghi ƒë√®, kh√¥ng c·ªông d·ªìn ng√†y.");
    }

    // ‚ö†Ô∏è N·∫øu ƒë√£ c√≥ g√≥i Lite v√† ch·ªçn l·∫°i Lite ‚Üí c·∫£nh b√°o m·∫•t hi·ªáu l·ª±c c≈©
    if (hasLite && code === "vip_ai_lite") {
      showToast("‚ö†Ô∏è B·∫°n hi·ªán t·∫°i ƒëang s·ªü h·ªØu g√≥i Lite. N·∫øu b·∫°n ch·ªçn g√≥i Lite n√†y, g√≥i hi·ªán t·∫°i s·∫Ω b·ªã m·∫•t hi·ªáu l·ª±c.");
    }

    // ‚úÖ Cho ch·ªçn g√≥i
    document.querySelectorAll('.package-option').forEach(p => p.classList.remove('selected'));
    el.classList.add('selected');
    selectedPackage = [code, price, displayName];
  }


</script>


</body>
</html>
